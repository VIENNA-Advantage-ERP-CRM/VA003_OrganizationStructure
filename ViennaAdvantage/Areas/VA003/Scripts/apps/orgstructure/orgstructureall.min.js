/***version 2.0.2.0*/
VA003=window.VA003||{},function(n,t){function i(){function sf(){cr=t('<a href="javascript:void(0)"  class="vis-icon-menuclose vis vis-mark"><\/a>');var n=t("<p>"+VIS.Msg.getMsg("VA003_OrgStructure")+" <\/p>");vt.append(au.append(cr).append(n));cr.click(function(n){y.frame&&y.frame.dispose();y=null;n.stopPropagation()})}function hf(){ii=t('<div style="padding: 0px;border-right: white;" class="VA003-left-tree-wrap">');et.append(t('<div class="VA003-left-tree" style="padding: 0px;overflow:auto">').append(ii)).append(t('<div class="VA003-div-reportgeneratediv">').append(ei).append(gt).append(lu));var n=et.outerHeight()-(bt.outerHeight()+ei.outerHeight()+130);ii.parent().height(n)}function cf(){i=t('<div class="vis-busyindicatorouterwrap"><div class="vis-busyindicatorinnerwrap"><i class="vis-busyindicatordiv"><\/i><\/div><\/div>');i[0].style.visibility="hidden";vt.append(i)}function lf(){var n=t('<div class="VA003-rightinnerwrapper">'),r,i;s.append(n);r=t("<div>");kr=t('<ul class="VA003-topRight-icons">');sr=t('<li><a  style="padding:0px" ><span style="height:31px;width:31px" class="VA003-Refresh-icon vis vis-refresh"><\/span><\/a><\/li>');kt=t('<li><a  style="padding:0px" title="'+VIS.Msg.getMsg("VA003_AddNode")+'"><span style="height:31px;width:31px" class="VA003-AddNode-icon vis vis-tl-2"><\/span><\/a><\/li>');si=t('<li><a style="padding:0px" title="'+VIS.Msg.getMsg("VA003_AddTree")+'"><span style="height:31px;width:31px" class="VA003-AddTree-icon vis vis-plus"><\/span><\/a><\/li>');ir=t('<li ><a style="padding:0px" title="'+VIS.Msg.getMsg("VA003_ExpandTree")+'"><span style="height:31px;width:31px" class="VA003-Expand-icon"><\/span><\/a><\/li>');kr.append(sr).append(si).append(kt).append(ir);n.append(t('<div class="VA003-right-top">').append("<h4>"+VIS.Msg.getMsg("VA003_ReportingHierarchy")+"<\/h4>"));vt.append(s);i=t('<div class="VA003-righttopdatawrap">');su=t('<div class="VA003-form-data-drp">');n.append(i);i.append(su.append(b)).append(r.append(kr));o=t('<div style="float:left;width:100%" id="'+y.windowNo+'orgrighttree">');n.append(o);uu()}function af(){yi=t('<ul  class="vis-apanel-rb-ul">');yi.append('<li data-action="zoom" title='+VIS.Msg.getMsg("Zoom")+' style="opacity: 1"><i data-action="zoom" class="vis vis-find"><\/i><\/li>');yi.append('<li data-action="refresh"  title='+VIS.Msg.getMsg("Refresh")+' ><i data-action="refresh" class="vis vis-refresh"><\/i><\/li>')}function vf(){a.on("click",function(){a.css("opacity")!="0.5"&&(fr(),ae())});v.on("click",function(){v.css("opacity")!="0.5"&&(fr(),ve())});g.on("click",function(){g.css("opacity")!="0.5"&&(fr(),ye())});wi.on("change",function(){pu()});yt.on("click",rr);pt.on("click",ur);oi.on("change",tf);or.on("click",wf);u.on("click",pe);f.on("click",we);ei.on("click",be);b.on("change",rf);kt.on("click",ge);sr.on("click",rf);si.on("click",to);dt.on("click",no);lu.on("click",pu);hr.on("click",io);gt.on("click",gf);ir.on("click",ne);h.on("change",function(){h.val().length>0?h.removeClass("vis-ev-col-mandatory"):h.addClass("vis-ev-col-mandatory")});nr.on("click",bf);p.on("change",yf);yi.on(VIS.Events.onTouchStartOrClick,"LI",kf)}function yf(){var u,n,i;p.prop("checked")?(i=r.data("kendoTreeView").parent(r.data("kendoTreeView").select()),parent&&t(i.find(".data-id")[0]).data("active")==!1&&(at(!0),ut=!1,VIS.ADialog.info("VA003_SetActive"),p.prop("checked",!1))):(u=r.data("kendoTreeView").select(),n=r.data("kendoTreeView").select().find(".k-group").find(".data-id"),pf(n)||(at(!0),ut=!1,VIS.ADialog.info("VA003_SetInActive"),p.prop("checked",!0)))}function pf(n){var r=!0,i;if(n!=null&&n.length>0)for(i=0;i<n.length;i++)if(t(n[i]).data("active")){r=!1;break}return r}function wf(){var i=lt[0].files[0],n=!1,t;if(i?n=!0:l.attr("src")&&(n=!0),n){if(!VIS.ADialog.ask("DeleteIt"))return;t=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"OrgStructure/UpdateLogo",{AD_ORg_ID:c});t>0&&ki()}}function bf(){nr.w2overlay(yi.clone(!0))}function kf(n){var r=t(n.target).data("action");i[0].style.visibility="visible";r==VIS.Actions.refresh?t.ajax({url:VIS.Application.contextUrl+"OrgStructure/RefreshOrgType",async:!0,success:function(n){var r=JSON.parse(n),t;for(d.empty(),t=0;t<r.length;t++)d.append("<option value="+r[t].Key+">"+r[t].Name+"<\/option>");i[0].style.visibility="hidden"},error:function(n){console.log(n);i[0].style.visibility="hidden"}}):r==VIS.Actions.zoom&&vu(VIS.Utility.Util.getValueOfInt(d.val()),"Organization Type")}function df(){var n,i;bt=t('<div class="VA003-top-buttons">');n=t(' <ul class="VA003-topLeft-icons">');v=t('<li><a title="'+VIS.Msg.getMsg("VA003_AddNode")+'" class="VA003-org-icon"><\/a><\/li>');a=t('<li><a title="'+VIS.Msg.getMsg("VA003_AddLegalEntity")+'" class="VA003-entity-icon"><\/a><\/li>');g=t(' <li><a title="'+VIS.Msg.getMsg("VA003_AddOrgUnit")+'" class="VA003-orgUnit-icon"><\/a><\/li>');dt=t(' <li><a title="'+VIS.Msg.getMsg("Edit")+'" class="VA003-edit-icon"><\/a><\/li>');vr=t('<li class="VA003-shworgchkwrp"><\/li>');wi=t('<input type="checkbox" data-name="legal" >');cu=t("<li><label >"+VIS.Msg.getMsg("VA003_ShowOrgUnits")+"<\/label><\/li>");vr.append(wi).append(cu);hr=$btnHdrSend=t('<i class="VA003-InfoIcon vis vis-info" title="'+VIS.Msg.getMsg("VA003_info").replace("&","")+'"> <\/i>');au.append(hr);n.append(v).append(a).append(g).append(dt).append(vr);i=t('<ul class="VA003-topRight-icons">');pt=t('<li><a title="'+VIS.Msg.getMsg("VA003_Undo")+'"><span class="VA003-undo-icon vis vis-ignore"><\/span><\/a><\/li>');yt=t('<li><a title="'+VIS.Msg.getMsg("VA003_Save")+'"><span class="VA003-undo-icon vis vis-save"><\/span><\/a><\/li>');i.append(pt).append(yt);at(!0);bt.append(n).append(i);et.append(bt);vt.append(et)}function yu(){t.ajax({url:VIS.Application.contextUrl+"OrgStructure/GetTree",async:!0,data:{windowNo:y.windowNo,showOrgUnits:wi.is(":checked")},success:function(n){ii.append(r);wr=[];wu(n)}})}function pu(){yu()}function gf(){gt.hasClass("VA003-expand")?(gt.removeClass("VA003-expand"),gt.addClass("VA003-collapase"),r.data("kendoTreeView").expand(".k-item"),gt.prop("title",VIS.Msg.getMsg("VA003_CollapseTree"))):(gt.removeClass("VA003-collapase"),gt.addClass("VA003-expand"),r.data("kendoTreeView").collapse(".k-item"),gt.prop("title",VIS.Msg.getMsg("VA003_ExpandTree")))}function ne(){var n=ir.find("span");n.hasClass("VA003-Expand-icon")?(n.removeClass("VA003-Expand-icon"),n.addClass("VA003-collapse-icon"),o.data("kendoTreeView").expand(".k-item"),n.prop("title",VIS.Msg.getMsg("VA003_CollapseTree"))):(n.removeClass("VA003-collapse-icon"),n.addClass("VA003-Expand-icon"),o.data("kendoTreeView").collapse(".k-item"),n.prop("title",VIS.Msg.getMsg("VA003_ExpandTree")))}function wu(n){if(n==null||n==undefined)return null;var t=JSON.parse(n);di=t[0].TableName;gi=t[0].AD_Tree_ID;r.data("kendoTreeView")!=undefined&&(r.data("kendoTreeView").destroy(),r.empty());r.kendoTreeView({dataSource:t,dragAndDrop:!0,drop:ue,dragstart:re,select:ee,template:"<img src='"+VIS.Application.contextUrl+"#= item.ImageSource #' style='vertical-align: text-top;float: left;margin: 4px 0px 0px 10px;'><i class='#= item.ImageSource #'><\/i><p style='min-width:122px;border-radius:4px;margin:0px;padding: 7px 10px 7px 38px; background-color:#= item.bColor #; color: #= item.color #'>#= item.text #<\/p><input type='hidden' class='data-id' value='#= item.NodeID #' data-active='#= item.IsActive #' data-summary='#= item.IsSummary #' data-orgparentid='#= item.OrgParentID #' data-parentid='#= item.ParentID #'   data-legal='#= item.IsLegal #' data-isorgunit='#= item.IsOrgUnit #' data-Treeparentid='#= item.TreeParentID #' data-treeid='"+gi+"' />"});r.data("kendoTreeView").select(".k-first");window.setTimeout(function(){r.find(".k-in").css({cursor:"pointer"})},100);y.sizeChanged();nt(!0);du();ni(!1);i[0].style.visibility="hidden"}function te(){var r,n,a,i,c;ti=t('<div class="VA003-form-wrap vis-formouterwrpdiv">');var e=t('<div class="VA003-forminnerwrap">'),o=t('<div class="VA003-form-top">'),s=t('<div class="VA003-form-top-fields">');e.append(o);ri=t('<label class="VA003-formheadingwrap">'+VIS.Msg.getMsg("VA003_OrgInfo")+"<\/label>");ti.append(e.append(o.append(t('<div class="VA003-form-data"><\/div>').append(ri)).append(s)));tt=t('<input type="text" data-name="searchkey">');s.append(t('<div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(tt).append("<label>"+VIS.Msg.getMsg("SearchKey")+"<\/label>")));ft(tt);h=t('<input type="text" data-name="name">');s.append(t(' <div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(h).append("<label>"+VIS.Msg.getMsg("Name")+"<\/label>")));ft(h);r=t('<div class="VA003-image-wrap">');l=t('  <img src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-org-logo.png" alt="Organization Logo">');r.append(t('<span class="VA003-image-area">').append(l));oi=t('<a><span class="vis vis-pencil" style="cursor: pointer;"><input type="file" style="position: absolute; top: 0px; right: 0px; opacity: 0;cursor: pointer;"><\/span><\/a>');or=t('<a class="vis vis-cross" style="cursor:pointer"><\/a>');lt=oi.find("input");r.append(t('<div class="VA003-image-upload">').append(t(' <div class="VA003-imageuploadinner"> <\/div>').append(oi).append(or)));o.append(r);n=t('<div class="VA003-form-fullFields">');e.append(n);a=new VIS.MLocationLookup(er,y.windowNo);w=new VIS.Controls.VLocation("C_Location_ID",!1,!1,!0,VIS.DisplayType.Location,a);t(w.getControl()).data("name","address");n.append(t('<div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(w.getControl().attr("data-hasbtn"," ").addClass("VA003-addressControl")).append("<label>"+VIS.Msg.getMsg("Address")+"<\/label>")).append(t('<div class="input-group-append">').append(w.getBtn(0)).append(w.getBtn(1))));w.fireValueChanged=ie;nr=t('<button tabindex="-1" class="vis-controls-txtbtn-table-td2 input-group-text"><i tabindex="-1" class="fa fa-ellipsis-v"><\/i><\/button>');d=t('<select data-name="orgtype" data-hasbtn=" ">');n.append(t(' <div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(d).append("<label>"+VIS.Msg.getMsg("VA003_OrgType")+"<\/label>")).append(t('<div class="input-group-append">').append(nr)));ft(d);ot=t('<input type="text" data-name="taxid">');n.append(t(' <div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(ot).append("<label>"+VIS.Msg.getMsg("VA003_TaxID")+"<\/label>")));ft(ot);st=t('<input type="text" data-name="phone">');n.append(t(' <div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(st).append("<label>"+VIS.Msg.getMsg("Phone")+"<\/label>")));ft(st);ht=t('<input type="text"  data-name="email">');n.append(t(' <div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(ht).append("<label>"+VIS.Msg.getMsg("EMail")+"<\/label>")));ft(ht);ct=t('<input type="text" data-name="fax">');n.append(t(' <div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(ct).append("<label>"+VIS.Msg.getMsg("Fax")+"<\/label>")));ft(ct);i=t(' <div class="VA003-form-data">');u=t('<input type="checkbox" data-name="legal">');i.append(t(' <div style="width:50%; margin-bottom: 15px"  class="VA003-form-data">').append(u).append("<label>"+VIS.Msg.getMsg("VA003_LegalEntity")+"<\/label>"));ft(u);f=t('<input type="checkbox" data-name="summary">');i.append(t(' <div style="width:50%; margin-bottom: 15px" class="VA003-form-data">').append(f).append("<label>"+VIS.Msg.getMsg("VA003_SummaryLevel")+"<\/label>"));ft(f);it=t('<input type="checkbox" data-name="summary">');ui=t(' <div style="width:50%; margin-bottom: 15px" class="VA003-form-data">').append(it).append("<label>"+VIS.Msg.translate(VIS.Env.getCtx(),"IsCostCenter")+"<\/label>");i.append(ui);ft(it);rt=t('<input type="checkbox" data-name="summary">');fi=t(' <div style="width:50%; margin-bottom: 15px" class="VA003-form-data">').append(rt).append("<label>"+VIS.Msg.translate(VIS.Env.getCtx(),"IsProfitCenter")+"<\/label>");i.append(fi);ft(rt);n.append(i);c=t(' <div class="VA003-form-data">');p=t('<input type="checkbox" data-name="Active">');c.append(t(' <div style="width:50%" class="VA003-form-data">').append(p).append("<label>"+VIS.Msg.getMsg("VA003_Active")+"<\/label>"));ft(p);p.prop("checked",!0);n.append(c);et.append(ti)}function ai(n){n?ri.text(VIS.Msg.getMsg("VA003_AddOrg")):ri.text(VIS.Msg.getMsg("VA003_OrgInfo"))}function ie(){ut=!0;at(!1)}function re(n){if(ut){n.preventDefault();window.setTimeout(function(){VIS.ADialog.ask("VA003_SaveExisting")?rr():ur()},200);ut=!1;return}}function ue(n){var c,y,p,w,k,d,l,f,s,u;if(!n.valid){n.preventDefault();return}if(n.dropPosition=="before"){n.preventDefault();return}if(n.dropPosition=="after"){n.preventDefault();return}if(c=t(n.sourceNode).find(".data-id").data("summary"),y=t(n.sourceNode).find(".data-id").data("isorgunit")?"'Y'":"'N'",li!=null&&li.length>0&&li.contains("IsOrgUnit")){if(p=li.substring(li.indexOf("=")+1),y!=p){n.preventDefault();return}}else if(t(n.sourceNode).find(".data-id").data("isorgunit")){n.preventDefault();return}if(w=t(n.destinationNode).find(".data-id").data("treeid"),k=t(n.sourceNode).find(".data-id").data("treeid"),k!=w){if(d=t(n.sourceNode).find(".data-id").data("active"),!d)return n.preventDefault(),!1;n.preventDefault();t(n.destinationNode).find(".data-id").data("summary")&&(fe(this,n),b.trigger("change"));return}if(l=t(n.sourceNode).find(".data-id").data("legal"),t(n.destinationNode).find(".data-id").data("summary")!=!0&&l==!0){n.preventDefault();return}if(f=t(n.destinationNode).find(".data-id").data("summary"),c&&!f){n.preventDefault();return}var g=t(n.sourceNode).find(".data-id").data("treeid"),a=t(n.sourceNode).find(".data-id").val(),v=t(n.sourceNode).find(".data-id").data("treeparentid"),e=t.grep(wr,function(n){return n.id==a});if(e!=undefined&&e!=null&&e.length>0&&(v=e[0].pid),s=t(n.destinationNode).find(".data-id").val(),f&&(s=0),u=0,t(n.destinationNode).find(".data-id").data("summary")==!0?u=t(n.destinationNode).find(".data-id").val():u==0&&f&&(u=t(n.destinationNode).find(".data-id").val()),v==u&&f&&t(n.destinationNode).find(".data-id").val()>0){n.preventDefault();return}t(n.sourceNode).find(".data-id")[0].setAttribute("data-treeparentid",u);e!=undefined&&e!=null&&e.length>0?e[0].pid=u:wr.push({id:a,pid:u});t(n.sourceNode).find(".data-id").data("orgparentid",s);f?(s=0,t(n.sourceNode).find(".data-id").data("parentid",parseInt(u))):t(n.sourceNode).find(".data-id").data("parentid",0);i[0].style.visibility="visible";var h=t(n.sourceNode).siblings(),tt=t(n.destinationNode),o=t(n.destinationNode).children("ul").children(),nt=t(n.sourceNode).find(".data-id").data("active");o==null||o==""||o.length==0?window.setTimeout(function(){o=tt.children("ul").children();gu(h,v,o,u,g,f,a,s,!0);r.data("kendoTreeView").trigger("select",{node:t(n.sourceNode)});bu(l,c,nt,t(n.sourceNode))},200):window.setTimeout(function(){o=t(n.destinationNode).children("ul").children();h.length==1&&h.find(".data-id").val()==u&&(h=[]);gu(h,v,o,u,g,f,a,s,!0);r.data("kendoTreeView").trigger("select",{node:t(n.sourceNode)});bu(l,c,nt,t(n.sourceNode))},200)}function bu(n,i,u,f){var o=r.data("kendoTreeView").findByUid(f.data("uid"));r.data("kendoTreeView").select(o);n?u?(t(e.sourceNode).data("uid"),t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","#dc8a20")):t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","#F4C993"):i?u?t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","#0084c4"):t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","rgba(0, 132, 196, 0.7)"):u?t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","rgba(43, 174, 250, 0.78)"):t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","rgba(166, 222, 255, 1)")}function ku(n){var u,f,l,s,r,e;if(!n.valid){n.preventDefault();return}if(n.dropPosition=="before"&&t(n.destinationNode).find(".data-id").val()==0){n.preventDefault();return}if(u=!1,n.dropPosition=="before"?u=!0:n.dropPosition=="after"&&(u=!0),f=t(n.destinationNode).find(".data-id").data("summary"),!f&&!u){n.preventDefault();return}if(l=t(n.sourceNode).find(".data-id").data("legal"),l&&!f&&!u){n.preventDefault();return}if(s=t(n.sourceNode).find(".data-id").data("summary"),s&&!f){n.preventDefault();return}var v=t(n.sourceNode).find(".data-id").data("treeid"),h=t(n.sourceNode).find(".data-id").val(),o=t(n.sourceNode).find(".data-id").data("treeparentid");if(o==0&&s&&(o=t(n.sourceNode).find(".data-id").val()),r=t.grep(br,function(n){return n.id==h}),r!=undefined&&r!=null&&r.length>0&&(o=r[0].pid),e=0,e=u?t(n.destinationNode).find(".data-id").data("treeparentid"):t(n.destinationNode).find(".data-id").val(),o==e&&!u){n.preventDefault();return}r!=undefined&&r!=null&&r.length>0?r[0].pid=e:br.push({id:h,pid:e});i[0].style.visibility="visible";var a=t(n.sourceNode).siblings(),y=t(n.destinationNode),c=t(n.destinationNode).children("ul").children();window.setTimeout(function(){f&&(c=t(n.destinationNode).children("ul").children());u&&(c=t(n.destinationNode).parent().children("li"));a=[];se(a,o,c,e,v,f,h,null,!1)},200)}function fe(n,i){var l=n.dataItem(i.sourceNode).toJSON(),a=t(i.destinationNode),v=t(i.sourceNode).find(".data-id").val(),c=t(i.destinationNode).find(".data-id").val(),s=t(i.destinationNode).find(".data-id").data("treeid"),u=t(t(i.sourceNode).find(".data-id")[0]),h=0,f,e,o,r;try{f=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"OrgStructure/LoadSequenceforTree",{TreeId:s});f!=null&&(h=f)}catch(y){}for(e=[],o=[],r=0;r<u.length;r++)e[r]=t(u[r]).val(),o[r]=t(u[r]).data("active")==!0?"Y":"N";VIS.dataContext.getJSONData(VIS.Application.contextUrl+"OrgStructure/InsertTreeNode",{Chidrens:e,IsActive:o,ParentID:c,TreeIds:s,ChildCount:VIS.Utility.Util.getValueOfInt(h)})}function ee(n){var o,u,e,s;if(ut)if(VIS.ADialog.ask("VA003_SaveExisting")){if(o=rr(),!o){n.preventDefault();return}}else ur();ri.text(VIS.Msg.getMsg("VA003_OrgInfo"));u=t(n.node).find(".data-id");e=u.val();i[0].style.visibility="visible";e>0?(oe(),nt(!1),ce(e,!1),pr=!1,ni(!1)):(du(),nt(!0),pr=!0,vi(),gr(),ni(!1),i[0].style.visibility="hidden");s=u.data("orgparentid");s>0&&f.prop("disabled",!0);ci=u.data("summary");(!ci||u.data("legal"))&&(a.prop("disabled",!0),a.css("opacity","0.5"));ci||u.data("legal")||(g.prop("disabled",!0),g.css("opacity","0.5"));ci?(v.prop("disabled",!1),v.css("opacity","1")):(v.prop("disabled",!0),v.css("opacity","0.5"));ci?(k=u.val(),wt=0):(k=u.data("treeparentid"),wt=u.val());(k=="undefined"||k==null||k==undefined)&&(k=0);window.setTimeout(function(){r.find(".k-in").css({cursor:"pointer"});r.find(".k-state-focused.k-state-selected").css({"box-shadow":"none","-webkit-box-shadow":"none"})},100)}function du(){a.prop("disabled",!1);a.css("opacity","1");g.prop("disabled",!1);g.css("opacity","1");h.attr("disabled",!0);tt.attr("disabled",!0);u.attr("disabled",!0);f.attr("disabled",!0);p.attr("disabled",!0);vi();ki()}function oe(){a.prop("disabled",!1);a.css("opacity","1");g.prop("disabled",!1);g.css("opacity","1");h.attr("disabled",!1);tt.attr("disabled",!1);p.attr("disabled",!1);u.attr("disabled",!1);f.attr("disabled",!1)}function gu(n,r,u,f,e,o,s,h){for(var v,y,l=[],a=[],c=0;c<n.length;c++)l[c]=VIS.Utility.Util.getValueOfInt(t(n[c]).find(".data-id").val());for(c=0;c<u.length;c++)a[c]=t(u[c]).find(".data-id").val();v=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"OrgStructure/UpdateSequence",{TableName:di,OldID:r,NewId:f,TreeId:e,OldSibling:l,NodId:NodeIds});y=f;VIS.dataContext.getJSONData(VIS.Application.contextUrl+"OrgStructure/UpdateParentNode",{TreeId:e,CurrentNode:s,NewIdForOrg:h,IsSummery:o});i[0].style.visibility="hidden"}function se(n,r,u,f,e){for(var h,c,n=[],s=[],o=0;o<n.length;o++)n[o]=VIS.Utility.Util.getValueOfInt(t(n[o]).find(".data-id").val());for(o=0;o<u.length;o++)s[o]=t(u[o]).find(".data-id").val();h=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"OrgStructure/UpdateSequence",{TableName:di,OldID:r,NewId:f,TreeId:e,OldSibling:n,NodId:s});c=f;console.log(s);i[0].style.visibility="hidden"}function he(){t.ajax({url:VIS.Application.contextUrl+"OrgStructure/LoadLookups",success:function(n){var t=JSON.parse(n);t&&hu==!1&&(le(t.AllOrgType,t.AllReportHierarchy,t),hu=!0)}})}function ce(n,r){t.ajax({url:VIS.Application.contextUrl+"OrgStructure/GetOrgInfo",async:!0,data:{orgID:n,loadLookups:r},success:function(n){var t=JSON.parse(n);c=t.OrgID;wt=c;nf(t,!0);i[0].style.visibility="hidden"},error:function(n){VIS.ADialog.error("VA003_ErrorgettingOrg"+n);i[0].style.visibility="hidden"}})}function le(n,t,i){if(n)for(var r=0;r<n.length;r++)d.append("<option value="+n[r].Key+">"+n[r].Name+"<\/option>");fu(t);h.attr("maxlength",i.NameLength);tt.attr("maxlength",i.ValueLength);ht.attr("maxlength",i.EMailLength);ct.attr("maxlength",i.FaxLength);st.attr("maxlength",i.PhoneLength);ot.attr("maxlength",i.TaxIDLength);tr=i.NameLength;lr=i.ValueLength;ar=i.TreeNameLength}function nf(n,i){f.attr("disabled",!1);yr||u.attr("disabled",!1);n==null||n==undefined?(tt.val(""),h.val(""),ot.val(""),ht.val(""),st.val(""),ct.val(""),w.setValue(null),u.prop("checked",!1),d.val(-1),f.prop("checked",!1),nt(!1),ki(),ni(!0)):(tt.val(n.SearchKey),h.val(n.Name),d.val(n.OrgType),ot.val(n.TaxID),ht.val(n.EmailAddess),st.val(n.Phone),ct.val(n.Fax),n.C_Location_ID==0?w.setValue(null):w.setValue(n.C_Location_ID),n.IsLegalEntity!=null&&n.IsLegalEntity!=""?(u.prop("checked",n.IsLegalEntity),nt(!1)):(u.prop("checked",!1),nt(!1)),n.IsSummary!=null&&n.IsSummary!=""?(f.prop("checked",n.IsSummary),nt(!0)):(f.prop("checked",!1),nt(!1)),n.ParentOrg>0?(u.prop("disabled",!0),f.prop("disabled",!0),yr=!0):(u.prop("disabled",!1),f.prop("disabled",!1),yr=!1),n.IsActive?p.prop("checked",n.IsActive):p.prop("checked",!1),n.profitCenter!=undefined&&n.profitCenter!=null&&n.profitCenter!=""?rt.prop("checked",n.profitCenter):rt.prop("checked",!1),n.costCenter!=undefined&&n.costCenter!=null&&n.costCenter!=""?it.prop("checked",n.costCenter):it.prop("checked",!1),n.OrgImage!=null&&n.OrgImage!=undefined&&n.OrgImage.length>0?(l.show(),t(l.parent()).css("background-color","white"),l.attr("src",VIS.Application.contextUrl+n.OrgImage)):ki(),i&&gr(n),ni(!1))}function ki(){t(l.parent()).css("background-color","rgba(var(--v-c-secondary), .4)");l.attr("src",null);l.hide()}function gr(n){hi=n?{Tenant:n.Tenant,SearchKey:n.SearchKey,Name:n.Name,TaxID:n.TaxID,EmailAddess:n.EmailAddess,Phone:n.Phone,Fax:n.Fax,C_Location_ID:n.C_Location_ID,IsSummary:n.IsSummary,IsLegalEntity:n.IsLegalEntity,OrgImage:n.OrgImage,IsActive:n.IsActive,costCenter:n.costCenter,profitCenter:n.profitCenter}:{Tenant:"",SearchKey:"",Name:"",TaxID:"",EmailAddess:"",Phone:"",Fax:"",C_Location_ID:"",IsSummary:"",IsLegalEntity:"",OrgImage:"",IsActive:"",costCenter:"",profitCenter:""}}function ae(){var n=nu();n||(at(!1),tu(),iu(a),vi(),ni(!0),ai(!0),nt(!1),f.attr("disabled",!0),u.attr("disabled",!0),f.prop("checked",!1),u.prop("checked",!0),it.prop("checked",!1),rt.prop("checked",!1),ui.hide(),fi.hide())}function ve(){var n=nu();n||(at(!1),iu(v),vi(),ai(!0),tu(),nt(!0),ni(!0),f.attr("disabled",!0),u.attr("disabled",!0),f.prop("checked",!0),u.prop("checked",!1),it.prop("checked",!1),rt.prop("checked",!1),ui.hide(),fi.hide())}function nu(){return ut?(VIS.ADialog.ask("VA003_SaveExisting")?rr():ur(),ut=!1,!0):!1}function ye(){var n=nu();n||(at(!1),tu(),iu(g),vi(),ni(!0),ai(!0),f.attr("disabled",!0),u.attr("disabled",!0),f.prop("checked",!1),u.prop("checked",!1),nt(!1),it.prop("checked",!1),rt.prop("checked",!1),ui.show(),fi.show())}function tu(){h.attr("disabled",!1);tt.attr("disabled",!1)}function iu(n){var t={to:ti,className:"VA003-ui-effects-transfer"};n.effect("transfer",t,600,function(){});lt.val("")}function vi(){c=0;tt.val("");h.val("");d.val(-1);ht.val("");st.val("");ct.val("");ot.val("");w.setValue(null);u.attr("checked",!1);f.attr("checked",!1);p.prop("checked",!0);ki()}function ni(n){n?h.addClass("vis-ev-col-mandatory"):pr||h.removeClass("vis-ev-col-mandatory")}function nt(n){d.attr("disabled",n);ht.attr("disabled",n);st.attr("disabled",n);ct.attr("disabled",n);ot.attr("disabled",n);w.getControl().attr("disabled",n);w.getBtn(0).attr("disabled",n);w.getBtn(1).attr("disabled",n);u.is(":checked")||f.is(":checked")?(it.attr("hidden",!0),rt.attr("hidden",!0),ui.attr("hidden",!0),fi.attr("hidden",!0),it.prop("checked",!1),rt.prop("checked",!1)):(it.attr("hidden",!1),rt.attr("hidden",!1),ui.attr("hidden",!1),fi.attr("hidden",!1));var t="white";n&&(t="#F4F4F4")}function ft(n){if(n.is(":text"))n.on("keydown",function(){ut=!0;at(!1)});else n.on("change",function(){ut=!0;at(!1)})}function rr(){if(yt.css("opacity")!="0.5"){if(h.val().trim().length==0){VIS.ADialog.info("EnterName");return}ut=!1;k==c&&(k=0);i[0].style.visibility="visible";window.setTimeout(function(){var n={OrgID:c,Tenant:er.getAD_Client_ID(),SearchKey:VIS.Utility.encodeText(tt.val().trim()),Name:VIS.Utility.encodeText(h.val().trim()),C_Location_ID:w.getValue(),TaxID:VIS.Utility.encodeText(ot.val().trim()),EmailAddess:VIS.Utility.encodeText(ht.val().trim()),Phone:VIS.Utility.encodeText(st.val().trim()),Fax:VIS.Utility.encodeText(ct.val().trim()),OrgType:d.val(),IsActive:p.is(":checked"),IsSummary:f.is(":checked"),IsLegalEntity:u.is(":checked"),ParentIDForSummary:k,AD_Tree_ID:gi,showOrgUnit:wi.is(":checked"),costCenter:it.is(":checked"),profitCenter:rt.is(":checked")};c!=0||hi==null||hi.IsSummary||(n.ParentOrg=wt);t.ajax({url:VIS.Application.contextUrl+"OrgStructure/InsertOrUpdateOrg",async:!0,data:n,success:function(e){var o,s,b;if(e){if(JSON.parse(e)=="VIS_OrgExist"){VIS.ADialog.warn("VA003_OrgExist");i[0].style.visibility="hidden";return}if(JSON.parse(e).indexOf("Error")>-1){VIS.ADialog.warn(JSON.parse(e));i[0].style.visibility="hidden";return}if(o=p.is(":checked"),c==0){c=parseInt(JSON.parse(e));s={};s.color="white";s.NodeID=c;s.text=VIS.Utility.encodeText(h.val());s.IsSummary=!1;var l=f.is(":checked"),d=u.is(":checked"),y="",w="",g=r.data("kendoTreeView").select();u.is(":checked")?(y=o?"#dc8a20":"#F4C993",w="Areas/VA003/Images/orgstr-legal-entity.PNG"):f.is(":checked")?(y=o?"#0084c4":"rgba(0, 132, 196, 0.7)",w="Areas/VA003/Images/orgstr-org.png"):(y=o?"rgba(43, 174, 250, 0.78)":"rgba(166, 222, 255, 1)",w="Areas/VA003/Images/orgstr-store.PNG");(!l||d)&&(a.prop("disabled",!0),a.css("opacity","0.5"));l?(v.prop("disabled",!1),v.css("opacity","1")):(v.prop("disabled",!0),v.css("opacity","0.5"));l?(k=c,wt=0):(k=k,wt=c);b=r.data("kendoTreeView").append({text:VIS.Utility.encodeText(h.val()),bColor:y,color:"white",NodeID:c,IsSummary:l,ImageSource:w,ParentID:wt,TreeParentID:k,OrgParentID:parseInt(wt),IsLegal:d,IsActive:o},g);r.data("kendoTreeView").select(b);r.data("kendoTreeView").trigger("select",{node:b});tf();rt.prop("checked",!1);it.prop("checked",!1);VIS.ADialog.info("Saved");i[0].style.visibility="hidden"}else bi?(wu(e),vi(),nt(!0),i[0].style.visibility="hidden"):(VIS.ADialog.info("Saved"),u.is(":checked")?o?t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","#dc8a20"):t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","#F4C993"):f.is(":checked")?o?t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","#0084c4"):t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","rgba(0, 132, 196, 0.7)"):o?t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","rgba(43, 174, 250, 0.78)"):t(r.data("kendoTreeView").select().find("p")[0]).css("background-color","rgba(166, 222, 255, 1)"),o?t(t(r.data("kendoTreeView").select()).find(".data-id")[0]).data("active",!0):t(t(r.data("kendoTreeView").select()).find(".data-id")[0]).data("active",!1),i[0].style.visibility="hidden");bi=!1;gr(n);at(!0)}ai(!1)},error:function(n){VIS.ADialog.error("VA003_ErrorInSaving"+n);ai(!1)}})},200)}}function ur(){pt.css("opacity")!="0.5"&&(ut=!1,nf(hi,!1),at(!0),ai(!1),ni(!1))}function at(n){pt.prop("disabled",n);yt.prop("disabled",n);n?(pt.css("opacity",".5"),yt.css("opacity",".5")):(pt.css("opacity","1"),yt.css("opacity","1"))}function tf(){var r,u,n,f;if(c>0){if(n=lt[0].files[0],n!=null&&n!=undefined){if(n.size>51200){lt.val("");VIS.ADialog.info("VA003_picSize");return}i[0].style.visibility="visible";r=new XMLHttpRequest;u=new FormData;u.append("pic",n);u.append("orgID",c);r.open("POST",VIS.Application.contextUrl+"OrgStructure/UploadPic");r.send(u);r.addEventListener("load",function(n){var r=n.target.response,u=JSON.parse(r),f=JSON.parse(u);l.show();t(l.parent()).css("background-color","white");l.attr("src",VIS.Application.contextUrl+f);i[0].style.visibility="hidden"})}lt.val("")}else if(n=lt[0].files[0],n){if(n.size>51200){lt.val("");VIS.ADialog.info("VA003_picSize");return}f=new FileReader;f.onloadend=function(){l.show();t(l.parent()).css("background-color","white");l.attr("src",f.result)};f.readAsDataURL(n)}}function pe(){c>0&&(f.is(":checked")&&f.prop("checked",!1),bi=!0);nt(u.is(":checked"))}function we(n){if(c>0){if(u.is(":checked")){if(!VIS.ADialog.ask("VA003_changeToSummary")){n.preventDefault();return}u.prop("checked",!1);bi=!0}else if(!ci&&f.is(":checked")){if(!VIS.ADialog.ask("VA003_changeToSummary")){n.preventDefault();return}u.attr("checked",!1);bi=!0}f.is(":checked")?u.attr("disabled",!0):u.attr("disabled",!1)}nt(f.is(":checked"))}function be(){i[0].style.visibility="visible";window.setTimeout(function(){t.ajax({url:VIS.Application.contextUrl+"OrgStructure/GenerateHeirarchy",async:!0,data:{windowNo:y.windowNo},success:function(n){var t=JSON.parse(n),r,u;if(t!=null){if(t=="ProcessFailed"){VIS.ADialog.error("ProcessFailed");i[0].style.visibility="hidden";return}if(t=="ProcessNoInstance"){VIS.ADialog.error("ProcessNoInstance");i[0].style.visibility="hidden";return}if(jQuery.type(t)=="string"&&t.indexOf("Error")>-1){VIS.ADialog.error(t);i[0].style.visibility="hidden";return}r=t.AllReportHierarchy;fu(r);u=t.Tree;ru(u)}},error:function(n){console.log(n);VIS.ADialog.error("VA003_ControllerNotFound");i[0].style.visibility="hidden"}})},200)}function rf(){br=[];var n=b.val();if(n<0){o.data("kendoTreeView")!=undefined&&(o.data("kendoTreeView").destroy(),o.empty());return}b.find("option:selected").data("isdefault")=="Y"?kt.css("opacity","0.5"):kt.css("opacity","1");i[0].style.visibility="visible";t.ajax({url:VIS.Application.contextUrl+"OrgStructure/CreateTree",data:{windowNo:y.windowNo,treeID:n},success:function(n){treeData=JSON.parse(n);ru(treeData);b.find("option:selected").data("isdefault")=="N"&&o.data("kendoTreeView").expand(".k-item")},error:function(){VIS.ADialog.error("VA003_ControllerNotFound");i[0].style.visibility="hidden"}})}function ru(n){var r,u,f,e;o.data("kendoTreeView")!=undefined&&(o.data("kendoTreeView").destroy(),o.empty());r=b.find("option:selected").data("isdefault")=="Y"?!1:!0;u=n[0].AD_Tree_ID;li=n[0].WhereClause;r?o.kendoTreeView({dataSource:n,dragAndDrop:r,drop:ku,select:uf,template:"<div style='float: left;border-radius: 4px;display: inline-flex; align-items: center; background: #= item.bColor #;'><img src='"+VIS.Application.contextUrl+"#= item.ImageSource #' style='vertical-align: text-top;float: left;margin: 0px 0px 0px 10px; '><i class='#= item.ImageSource #' style='float: left;'><\/i><p style='float: left;min-width:122px;border-radius:4px;margin:0px;padding: 7px 10px 7px 10px;  color: #= item.color #'>#= item.text #<\/p><input type='hidden' class='data-id' value='#= item.NodeID #'  data-legal='#= item.IsLegal #'  data-summary='#= item.IsSummary #'  data-parentid='#= item.ParentID #'  data-Treeparentid='#= item.TreeParentID #'   data-treeid='"+u+"' /><\/div><div style='float:left; display: flex; align-items: center;'><a style='display:#= item.DeleteVisibility #' title='"+VIS.Msg.getMsg("Delete")+"' class='VA003-delete-link vis vis-mark' ><\/a><a style='display:#= item.Visibility #' title='"+VIS.Msg.getMsg("VA003_Rename")+"'  class='VA003-rename-link vis vis-pencil' ><\/a><\/div>"}):o.kendoTreeView({dataSource:n,dragAndDrop:r,drop:ku,select:uf,template:"<div style='float: left;border-radius: 4px;float: left;border-radius: 4px;display: inline-flex; align-items: center;background: #= item.bColor #;'><img src='"+VIS.Application.contextUrl+"#= item.ImageSource #' style='vertical-align: text-top;float: left;margin: 0px 0px 0px 10px; '><i class='#= item.ImageSource #' style='float: left;'><\/i><p style='float: left;min-width:122px;border-radius:4px;margin:0px;padding: 7px 10px 7px 10px;  color: #= item.color #'>#= item.text #<\/p><input type='hidden' class='data-id' value='#= item.NodeID #'  data-legal='#= item.IsLegal #'  data-summary='#= item.IsSummary #'  data-parentid='#= item.ParentID #'  data-Treeparentid='#= item.TreeParentID #'   data-treeid='"+u+"' /><\/div><div style='float:left;display:#= item.Visibility #'><a title='"+VIS.Msg.getMsg("VA003_Rename")+"'  class='VA003-rename-link vis vis-pencil' ><\/a><\/div>"});o&&(f=t(s.find(".VA003-right-top")).outerHeight(),e=t(s.find(".VA003-form-data")).outerHeight(),o.height(s.outerHeight()-120));window.setTimeout(function(){o.find(".k-in").css({cursor:"pointer"})},100);s.off(VIS.Events.onTouchStartOrClick,".VA003-delete-link");s.on(VIS.Events.onTouchStartOrClick,".VA003-delete-link",de);s.off(VIS.Events.onTouchStartOrClick,".VA003-rename-link");s.on(VIS.Events.onTouchStartOrClick,".VA003-rename-link",ke);i[0].style.visibility="hidden"}function uf(){window.setTimeout(function(){o.find(".k-in").css({cursor:"pointer"})},100)}function ke(){var s=t(t(this).closest(".k-item")).find(".data-id").val(),u=o.data("kendoTreeView"),h=u.dataItem(u.select()).text,f=t('<div class="vis-formouterwrpdiv">'),e=t('<div style="width:100%" class="VA003-form-top-fields">'),r=t('<input  maxlength="'+tr+'" type="text" data-name="name" placeholder=" " data-placeholder="">'),n;r.val(h);r.select();e.append(t('<div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(r).append("<label>"+VIS.Msg.getMsg("Name")+"<\/label>")));f.append(e);n=new VIS.ChildDialog;n.setContent(f);n.setWidth("350px");n.setTitle(VIS.Msg.getMsg("VA003_RenameNode"));n.setModal(!0);n.onClose=function(){};n.show();n.onOkClick=function(){if(r.val().trim().length==0){VIS.ADialog.info("EnterName");return}i[0].style.visibility="visible";VIS.dataContext.getJSONData(VIS.Application.contextUrl+"OrgStructure/UpdateOrgnization",{Name:VIS.Utility.encodeText(r.val()),AD_Org_ID:s});var n=o.data("kendoTreeView");n.dataItem(n.select()).set("text",VIS.Utility.encodeText(r.val()));i[0].style.visibility="hidden"};n.onCancelClick=function(){}}function de(){var n,r,u;VIS.ADialog.ask("DeleteIt")&&(i[0].style.visibility="visible",n=o.data("kendoTreeView"),n.remove(t(this).closest(".k-item")),r=t(t(this).closest(".k-item")).find(".data-id").val(),u=t(t(this).closest(".k-item")).find(".data-id").data("treeid"),VIS.dataContext.getJSONData(VIS.Application.contextUrl+"OrgStructure/DeleteAD_TreeNode",{TreeId:u,Parent_ID:r}),i[0].style.visibility="hidden")}function ge(){if(kt.css("opacity")!="0.5"){var t=o.data("kendoTreeView").select().find(".data-id").val(),i=new n.OrgStructure.AddNode(b.val(),y,t,tr,lr);i.show()}}function no(){s.data("isexpanded")=="N"?(s.data("isexpanded","Y"),s.animate({width:"67%"},800,function(){dt.find("img").attr("src",VIS.Application.contextUrl+"Areas/VA003/Images/orgstr-toggle.png");uu()}),dt.find("a").removeClass("VA003-toggle-icon"),dt.find("a").addClass("VA003-edit-icon")):fr()}function fr(){s.data("isexpanded")=="Y"&&(s.data("isexpanded","N"),s.animate({width:"35%"},800,function(){dt.find("img").attr("src",VIS.Application.contextUrl+"Areas/VA003/Images/arrow-left.png");uu()}),dt.find("a").addClass("VA003-toggle-icon"),dt.find("a").removeClass("VA003-edit-icon"))}function uu(){}function to(){var r=t('<div class="vis-formouterwrpdiv">'),u=t('<div style="width:100%" class="VA003-form-top-fields">'),e=t('<div style="width:100%" class="VA003-form-top-fields">'),f=t('<input maxlength="'+ar+'" type="text" data-name="name" placeholder=" " data-placeholder="">'),o=t('<input type="checkbox" data-name="isorgunit">'),n;u.append(t('<div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(f).append("<label>"+VIS.Msg.getMsg("Name")+"<\/label>")));e.append(t('<div style="margin-bottom:15px" class="VA003-form-top-fields">').append(o).append("<label>"+VIS.Msg.getMsg("VA003_OrgUnitTree")+"<\/label>"));r.append(u);r.append(e);u.append(t('<div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(f).append("<label>"+VIS.Msg.getMsg("Name")+"<\/label>")));r.append(u);n=new VIS.ChildDialog;n.setContent(r);n.setWidth("350px");n.setTitle(VIS.Msg.getMsg("VA003_AddTree"));n.setModal(!0);n.onClose=function(){};n.show();n.onOkClick=function(n){if(f.val().trim().length==0)return VIS.ADialog.info("EnterName"),n.preventDefault(),!1;i[0].style.visibility="visible";t.ajax({url:VIS.Application.contextUrl+"OrgStructure/AddNewTree",async:!0,data:{name:VIS.Utility.encodeText(f.val().trim()),IsOrgUnit:o.is(":checked")},success:function(n){var t=JSON.parse(n),r;if(t==null||t==undefined)return i[0].style.visibility="hidden",null;b.empty();r=t.AllReportHierarchy;fu(r)}})};n.onCancelClick=function(){}}function fu(n){var t,r;if(b.empty(),n)for(t=0;t<n.length;t++)r="<option ",n[t].Selected&&(r+=" selected "),r+=n[t].IsDefault?' data-isDefault="Y"':' data-isDefault="N" ',r+=" value="+n[t].Key+">"+VIS.Utility.encodeText(n[t].Name)+"<\/option>",b.append(r);b.trigger("change");i[0].style.visibility="hidden"}function io(){vt.find(".VA003-infoRoot-leftDivContainer").css("display","inherit");var t=new n.OrgStructure.info(y.removeinfo);t.init();dr=t.getRoot();vt.prepend(dr)}function ro(){var o=t('<div  class="VA003-infoRoot-leftDivContainer">'),s=t('<div  class="VA003-infoRoot-leftDiv">');t(et.find(".VA003-left-tree")).append(o);var n=t("<div>"),i=t("<div>"),r=t("<div>"),u=t("<div>"),f=t("<div>"),e=t("<div>");n.append(t('<div class="VA003-Info-Icons" ><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-org1.png"><\/div>'));n.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_SummaryNodes")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_SumaryInfo")+"<\/span><\/div><\/div>"));i.append(t('<div class="VA003-Info-Icons"><img src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-legal-entity1.png"><\/div>'));i.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_LegalNodes")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_LegalInfo")+"<\/span><\/div><\/div>"));r.append(t('<div class="VA003-Info-Icons"><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-store1.png"><\/div>'));r.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_OrgUnitsNodes")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_NonLegalInfo")+"<\/span><\/div><\/div>"));u.append(t('<div class="VA003-Info-Icons"><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-edit.png"><\/div>'));u.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("Edit")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_EditInfo")+"<\/span><\/div><\/div>"));f.append(t('<div class="VA003-Info-Icons"><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-folder-minus.png"><\/div>'));f.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_ExpandTree")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_ExpandTreeInfo")+"<\/span><\/div><\/div>"));e.append(t('<div class="VA003-Info-Icons"><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-folder-add.png"><\/div>'));e.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_CollapseTree")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_CollapseTreeInfo")+"<\/span><\/div><\/div>"));s.append(n).append(i).append(r).append(u).append(f).append(e);o.append(s)}function uo(){var r=t('<div  class="VA003-infoRoot-leftDivContainer">'),i=t('<div  class="VA003-infoRoot-leftDiv">'),n;i.append(t('<div style="display: block; padding: 0 15px;"><div style=" width: 100%; float: left; "><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_OrgInfo")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_OrgnizationInfo")+"<\/span><\/div><\/div>"));n=t('<div style="float:left;width:100%">');n.append(t('<div class="VA003-Info-Icons"><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-toggle.png"><\/div>'));n.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_EditUndo")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_EditUndoInfo")+"<\/span><\/div><\/div>"));i.append(n);ti.append(r);r.append(i)}function fo(){var e=t('<div style="margin-top:65px" class="VA003-infoRoot-leftDivContainer">'),n=t('<div  class="VA003-infoRoot-leftDiv">');n.append(t('<div style="display: block; padding: 0 15px;"><div style=" width: 100%; float: left; "><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_ReportingHierarchy")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_HieraryInfo")+"<\/span><\/div><\/div>"));var i=t("<div>"),r=t("<div>"),u=t("<div>"),f=t("<div>");u.append(t('<div class="VA003-Info-Icons"><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-folder-minus.png"><\/div>'));u.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_ExpandTree")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_ExpandTreeInfo")+"<\/span><\/div><\/div>"));f.append(t('<div class="VA003-Info-Icons"><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-folder-add.png"><\/div>'));f.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_CollapseTree")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_CollapseTreeInfo")+"<\/span><\/div><\/div>"));i.append(t('<div class="VA003-Info-Icons"><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-addtree.png"><\/div>'));i.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_AddTree")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_AddTreeInfo")+"<\/span><\/div><\/div>"));r.append(t('<div class="VA003-Info-Icons"><img class="VA003-infoRoot-icon" src="'+VIS.Application.contextUrl+'Areas/VA003/Images/orgstr-tree-node.png"><\/div>'));r.append(t('<div><div><span class="VA003-infoRoot-Header" >'+VIS.Msg.getMsg("VA003_AddNode")+'<\/span><\/div><div><span class="VA003-infoRoot-infos">'+VIS.Msg.getMsg("VA003_AddNodeinfo")+"<\/span><\/div><\/div>"));n.append(i).append(r).append(u).append(f);s.append(e);e.append(n)}var vu;this.frame=null;this.windowNo=null;var y=this,er=VIS.Env.getCtx(),c=0,wt=0,k=0,di="",gi=0,vt=t('<div class="VA003-content-wrap">'),eu=t("<div>"),ou=t('<div style="width:200px:height:100%;overflow:auto">'),et=t('<div class="VA003-leftMiddle-wrap">'),s=t('<div class="VA003-right-slide" data-isexpanded="Y">'),bt=null,ti=null,r=t("<div >"),ii=null,o=null,su=null,tt=null,h=null,u=null,f=null,p=null,d=null,ot=null,st=null,ht=null,ct=null,w=null,lt=null,l=null,oi=null,or=null,b=t("<select>"),ri=null,hu=!1,a=null,v=null,g=null,yt=null,pt=null,kt=null,sr=null,si=null,dt=null,hr=null,cr=null,yi=null,nr=null,tr=0,lr=0,ar=0,pi=0,vr=null,wi=null,cu=null,it=null,ui=null,rt=null,fi=null,ei=t('<button class="VA003-genrate-report"><i class="vis vis-cog"><\/i>'+VIS.Msg.getMsg("VA003_GenrateReportingHierarchy")+"<\/button>"),lu=t('<button class="VA003-refresh"><i class="vis vis-refresh"><\/i><\/button>'),gt=t('<button title="'+VIS.Msg.getMsg("VA003_ExpandTree")+'" class="VA003-expand"><\/button>'),ir=null,au=t('<div class="vis-awindow-header vis-menuTitle">'),i,hi=null,ff={},ci=!1,yr=!1,pr=!0,wr=[],br=[],ut=!1,ef=0,of=0,kr=null,dr=null,bi=!1,li=null;this.initializeComponent=function(){sf();df();hf();te();lf();cf();i[0].style.visibility="visible";he();yu();af();ro();uo();fo();vf()};vu=function(n){try{if(pi==0&&(pi=VIS.dataContext.getJSONData(VIS.Application.contextUrl+"OrgStructure/ZoomToWindow",null)),pi>0){var t=new VIS.Query;t.addRestriction("AD_OrgType",VIS.Query.prototype.EQUAL,n);t.setRecordCount(1);VIS.viewManager.startWindow(pi,t)}i[0].style.visibility="hidden"}catch(r){i[0].style.visibility="hidden";console.log(r)}};this.addNodeToTree=function(n){ru(n)};this.removeinfo=function(){vt.find(".VA003-infoRoot-leftDivContainer").css("display","none");dr.remove()};this.formSizeChanged=function(n){var r,u,i,f,e;n&&et.height(n);r=et.outerHeight()-(bt.outerHeight()+ei.outerHeight()+25+42);ii.parent().height(r);u=et.height()-(bt.height()+35+40);ti.height(u);i=s.find("#"+y.windowNo+"orgrighttree");i&&(f=t(s.find(".VA003-right-top")).height(),e=t(s.find(".VA003-form-data")).height(),i.height(s.height()-120))};this.getRoot=function(){return vt};this.disposeComponent=function(){s.off(VIS.Events.onTouchStartOrClick,".VA003-delete-link");s.off(VIS.Events.onTouchStartOrClick,".VA003-rename-link");a.off("click");v.off("click");g.off("click");yt.off("click");pt.off("click");lt.off("change");u.off("click");f.off("click");ei.off("click");b.off("change");kt.off("click");si.off("click");r.data("kendoTreeView")!=undefined&&(r.data("kendoTreeView").destroy(),r.empty());o.data("kendoTreeView")!=undefined&&(o.data("kendoTreeView").destroy(),o.empty());y.windowNo=null;er=null;c=0;wt=0;k=0;di="";gi=0;tt.remove();h.remove();u.remove();f.remove();d.remove();ot.remove();st.remove();ht.remove();ct.remove();tt=null;h=null;u=null;f=null;d=null;ot=null;st=null;ht=null;ct=null;w=null;$cmbWarehouse=null;lt.remove();l.remove();oi.remove();b.remove();ri.remove();lt=null;l=null;oi=null;b=null;ri=null;a.remove();v.remove();g.remove();yt.remove();pt.remove();kt.remove();si.remove();bt.remove();a=null;v=null;g=null;yt=null;pt=null;kt=null;si=null;bt=null;tr=null;lr=null;ar=null;$btnAddChildNode=null;ei.remove();ei=null;i.remove();i=null;hi=null;ff=null;pi=null;eu.remove();ou.remove();et.remove();s.remove();ti.remove();r.remove();ii.remove();o.remove();eu=null;ou=null;et=null;s=null;bt=null;ti=null;r=null;ii=null;o=null;vt.remove();vt=null;y.frame=null;y=null};this.lockUI=function(){};this.unlockUI=function(){};this.sizeChanged=function(n,t){ef=n;of=t;this.formSizeChanged(n,t)}}i.prototype.refresh=function(){this.formSizeChanged()};i.prototype.sizeChanged=function(n,t){this.sizeChanged(n,t)};i.prototype.init=function(n,t){this.frame=t;this.windowNo=n;t.setTitle("VA003_OrgStructure");t.hideHeader(!0);this.frame.getContentGrid().append(this.getRoot());this.initializeComponent()};i.prototype.dispose=function(){this.disposeComponent();this.frame=null};n.OrgStructure=i}(VA003,jQuery),function(n,t){n.OrgStructure.AddNode=function(n,i,r,u,f){function w(){h.append(t('<div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(v).append("<label>"+VIS.Msg.getMsg("SearchKey")+"<\/label>")));h.append(t('<div class="VA003-form-data input-group vis-input-wrap">').append(t('<div class="vis-control-wrap">').append(o).append("<label>"+VIS.Msg.getMsg("Name")+"<\/label>")));l=t('<button class="VIS_Pref_btn-2"  style="margin-top:0px;margin-bottom:0px;margin-right:10px;margin-left:10px;">'+VIS.Msg.getMsg("OK")+"<\/button>");a=t('<button class="VIS_Pref_btn-2"  style="margin-bottom:0px;margin-top:0px;">'+VIS.Msg.getMsg("Cancel")+"<\/button>");s.append(h).append(a).append(l);l.on("click",d);a.on("click",g)}function b(){$bsyDiv=t("<div>");$bsyDiv.css("position","absolute");$bsyDiv.css("bottom","0");$bsyDiv.css("background","url('"+VIS.Application.contextUrl+"Areas/VIS/Images/busy.gif') no-repeat");$bsyDiv.css("background-position","center center");$bsyDiv.css("width","97%");$bsyDiv.css("height","98%");$bsyDiv.css("text-align","center");$bsyDiv.css("z-index","1000");$bsyDiv[0].style.visibility="hidden";s.append($bsyDiv)}function k(){o.on("change",function(){o.val().length>0?o.removeClass("vis-ev-col-mandatory"):o.addClass("vis-ev-col-mandatory")})}function d(n){if(o.val().trim().length==0)return VIS.ADialog.info("EnterName"),n.preventDefault(),!1;$bsyDiv[0].style.visibility="visible";window.setTimeout(function(){t.ajax({url:VIS.Application.contextUrl+"OrgStructure/AddOrgNode",async:!1,data:{treeID:y,name:VIS.Utility.encodeText(o.val().trim()),description:"",value:VIS.Utility.encodeText(v.val().trim()),windowNo:p,parentID:r},success:function(t){var r=JSON.parse(t);if(r.ErrorMsg!=null&&r.ErrorMsg.length>0)return VIS.ADialog.error(r.ErrorMsg),$bsyDiv[0].style.visibility="hidden",n.preventDefault(),!1;i.addNodeToTree(r.Tree);$bsyDiv[0].style.visibility="hidden";e.close()},error:function(){$bsyDiv[0].style.visibility="hidden"}})},20)}function g(){e.close()}var y=n,p=i.windowNo,s=t('<div class="vis-formouterwrpdiv">'),h=t('<div style="width:100%" class="VA003-form-top-fields">'),e=null,c=this,l=null,a=null,v=t('<input maxlength="'+f+'" type="text" data-name="searchkey" placeholder=" " data-placeholder="">'),o=t('<input class="vis-ev-col-mandatory" maxlength="'+u+'"  type="text" data-name="name" placeholder=" " data-placeholder="">');b();this.show=function(){e=new VIS.ChildDialog;e.setContent(s);e.setWidth(340);e.setHeight(297);e.setTitle(VIS.Msg.getMsg("VA003_AddNode"));e.setModal(!0);e.onClose=function(){c.onClose&&c.onClose();c.dispose()};e.show();e.hideButtons();k();w()};this.dispose=function(){s.remove();s=null;h.remove();h=null;e=null;c=null}}}(VA003,jQuery),function(n,t){n.OrgStructure.info=function(n){function r(){i.append(t('<ul class="VA003-topRight-icons VA003-infoRoot-CloseInfo"><li><a style="float: initial;padding:0px"><span style="height:29px;width:29px" class="VA003-AddNode-infoCloseicon"><\/span><\/a><\/li><\/ul>'));t(i.find(".VA003-infoRoot-CloseInfo")).on("click",function(){n()})}var i=t('<div class="VA003-infoRoot">');this.init=function(){r()};this.getRoot=function(){return i}}}(VA003,jQuery)